{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Bioelectric Subroutine",
  "description": "A standardized definition of a morphological command triggered by bioelectric state change.",
  "type": "object",
  "required": ["id", "metadata", "target_morphology", "bioelectric_state", "hardware_drivers"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for this subroutine (e.g., 'xenopus_eye_induction_v1')."
    },
    "metadata": {
      "type": "object",
      "properties": {
        "author": { "type": "string" },
        "description": { "type": "string" },
        "version": { "type": "string" },
        "references": {
          "type": "array",
          "items": { "type": "string", "description": "DOI or citation for the source experiment." }
        }
      }
    },
    "target_morphology": {
      "type": "object",
      "description": "The high-level anatomical outcome.",
      "properties": {
        "organ": { "type": "string", "enum": ["eye", "limb", "head", "tail", "brain"] },
        "species": { "type": "string", "description": "Target organism (e.g., Xenopus laevis, Dugesia japonica)." },
        "action": { "type": "string", "enum": ["induce", "regenerate", "remodel", "suppress_tumor"] }
      }
    },
    "bioelectric_state": {
      "type": "object",
      "description": "The 'software' layer: the physiological state required to trigger the outcome.",
      "properties": {
        "target_vmem_range": {
          "type": "array",
          "items": { "type": "number" },
          "description": "The required membrane potential range in mV (e.g., [-20, -40])."
        },
        "spatial_domain": {
          "type": "string",
          "description": "Where this state must be applied (e.g., 'ventral_ectoderm', 'amputation_plane')."
        },
        "duration_hours": {
          "type": "number",
          "description": "How long the state must be maintained to trigger the module (e.g., 48 hours for planaria)."
        }
      }
    },
    "hardware_drivers": {
      "type": "array",
      "description": "The 'machine code': compatible molecular tools that can force this state.",
      "items": {
        "type": "object",
        "properties": {
          "type": { "type": "string", "enum": ["ion_channel_mRNA", "drug_cocktail", "optogenetics", "ionophore", "protein_complex", "ionophore_cocktail"] },
          "name": { "type": "string", "description": "Specific agent name (e.g., 'Kv1.5', 'H+ V-ATPase', 'Ivermectin')." },
          "mechanism_of_action": { "type": "string", "description": "e.g., 'Potassium efflux', 'Proton pumping', 'Gap junction blockade'." }
        }
      }
    }
  }
}
